<%- include('header', {seoDetails}) %>

  <!-- Start main-content -->
  <section class="page-title" style="background-image: url(/assets/images/data/RCP00163.webp);">
    <div class="auto-container">
      <div class="title-outer text-center">
        <h1 class="title">Venue</h1>
        <ul class="page-breadcrumb">
          <li><a href="/">Home</a></li>
          <li>Venue</li>
        </ul>
      </div>
    </div>
  </section>
  <!-- end main-content -->

  <!-- feature-section -->
  <section class="feature-section">
    <div class="auto-container">
       <% if (venues && Array.isArray(venues) && venues.length > 0) { %>
         <% venues.forEach((venue, index) => { %>
           <% 
             // Alternate layout: even index (0, 2, 4...) = image left, content right
             // odd index (1, 3, 5...) = content left, image right
             const isReversed = index % 2 === 1;
             const delay = (index + 1) * 100;
           %>
            <div class="row feature-row g-0 wow slideInUp" data-wow-delay="<%= delay %>ms">
              <% if (isReversed) { %>
                <!-- Content first, then image (reversed layout) -->
                <div class="content-column col-lg-8 col-md-12 col-sm-12">
                  <div class="inner-column">
                    <div class="content-box">
                      <div class="sec-title">
                        <span class="sub-title" style="text-transform: uppercase;">
                          <%= venue.tagline %>
                        </span>
                        <h2>
                          <%= venue.title %>
                        </h2>
                        <div class="text">
                          <%= venue.description %>
                        </div>
                      </div>
                      <div style="display: flex; gap: 15px;">
                        <a href="<%= venue.link || '#' %>" class="theme-btn btn-style-one read-more">More Details</a>

                      </div>

                    </div>
                  </div>
                </div>
                <div class="image-column col-lg-4 col-md-12 col-sm-12">
                  <div class="inner-column"  style="margin-top: 120px;">
                    <% 
                        // Extract YouTube video ID from URL
                        let youtubeVideoId = null;
                        if (venue.youtubeVideo) {
                            const youtubeUrl = venue.youtubeVideo;
                            // Handle different YouTube URL formats
                            if (youtubeUrl.includes('youtube.com/watch?v=')) {
                                youtubeVideoId = youtubeUrl.split('v=')[1]?.split('&')[0];
                            } else if (youtubeUrl.includes('youtu.be/')) {
                                youtubeVideoId = youtubeUrl.split('youtu.be/')[1]?.split('?')[0];
                            } else if (youtubeUrl.includes('youtube.com/embed/')) {
                                youtubeVideoId = youtubeUrl.split('embed/')[1]?.split('?')[0];
                            }
                        }
                    %>
                    <div class="image-box product-details rd-page">
                        <% if (youtubeVideoId) { %>
                            <div class="youtube-player-container" id="youtube-player-reversed-<%= index %>" style="width: 100%; height: 100%; position: relative;">
                                <!-- YouTube Player will be initialized here -->
                                <div class="youtube-overlay-blocker"></div>
                            </div>
                        <% } %>
                    </div>
                  </div>
                </div>
                <% } else { %>
                  <!-- Image first, then content (normal layout) -->
                  <div class="image-column col-lg-4 col-md-12 col-sm-12">
                    <div class="inner-column"  style="margin-top: 120px;">
                      <% 
                          // Extract YouTube video ID from URL
                          let youtubeVideoId = null;
                          if (venue.youtubeVideo) {
                              const youtubeUrl = venue.youtubeVideo;
                              // Handle different YouTube URL formats
                              if (youtubeUrl.includes('youtube.com/watch?v=')) {
                                  youtubeVideoId = youtubeUrl.split('v=')[1]?.split('&')[0];
                              } else if (youtubeUrl.includes('youtu.be/')) {
                                  youtubeVideoId = youtubeUrl.split('youtu.be/')[1]?.split('?')[0];
                              } else if (youtubeUrl.includes('youtube.com/embed/')) {
                                  youtubeVideoId = youtubeUrl.split('embed/')[1]?.split('?')[0];
                              }
                          }
                      %>
                      <div class="image-box product-details rd-page">
                          <% if (youtubeVideoId) { %>
                              <div class="youtube-player-container" id="youtube-player-<%= index %>" style="width: 100%; height: 100%; position: relative;">
                                  <!-- YouTube Player will be initialized here -->
                                  <div class="youtube-overlay-blocker"></div>
                              </div>
                          <% } %>
                      </div>
                    </div>
                  </div>
                  <div class="content-column col-lg-8 col-md-12 col-sm-12">
                    <div class="inner-column">
                      <div class="content-box">
                        <div class="sec-title">
                          <span class="sub-title" style="text-transform: uppercase;">
                            <%= venue.tagline %>
                          </span>
                          <h2>
                            <%= venue.title %>
                          </h2>
                          <div class="text">
                            <%= venue.description %>
                          </div>
                        </div>
                        <div style="display: flex; gap: 15px;">
                          <a href="<%= venue.link || '#' %>" class="theme-btn btn-style-one read-more">More Details</a>

                        </div>
       
                      </div>
                    </div>
                  </div>
                  <% } %>
            </div>
            <% }); %>
              <% } %>
    </div>
  </section>

  <style>
    .page-title {
        position: relative;
    }
    
    .page-title::before {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.3);
        z-index: 1;
    }
    
    .page-title .auto-container {
        position: relative;
        z-index: 2;
    }
    
    .feature-section .image-box {
        position: relative;
        width: 100%;
        overflow: hidden;
        height: 100%;
        background-size: cover !important;
        background-position: center !important;
        background-repeat: no-repeat !important;
    }

    .feature-section .book-now-btn:hover {
        background-color: var(--theme-color1, #222222) !important;
        color: white !important;
        border-color: var(--theme-color1, #222222) !important;
    }
    
    /* YouTube video player styles - ONLY for the container DIV, NOT iframe */
    .feature-section .image-box > div.youtube-player-container:not(iframe) {
        width: 100%;
        height: 100%;
        position: relative;
        overflow: hidden;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        isolation: isolate;
        background: transparent !important;
        background-image: none !important;
    }
    
    /* CRITICAL: EXPLICITLY prevent iframe from getting background styles - target iframe directly */
    .feature-section iframe.youtube-player-container,
    .feature-section iframe[id^="youtube-player"],
    .feature-section .youtube-player-container iframe,
    .feature-section iframe {
        background: transparent !important;
        background-image: none !important;
        background-color: transparent !important;
        background-size: unset !important;
        background-position: unset !important;
        background-repeat: unset !important;
    }
    
    /* Block ALL interactions with iframe - no hover, no clicks, nothing */
    .feature-section .youtube-player-container iframe,
    .feature-section iframe.youtube-player-container,
    .feature-section iframe[id^="youtube-player"],
    .feature-section .image-box iframe {
        width: 100%;
        height: 100%;
        border: none;
        pointer-events: none !important;
        -webkit-touch-callout: none;
        transform: translateZ(0) scale(1.45);
        -webkit-transform: translateZ(0) scale(1.45);
        transform-origin: center center;
        -webkit-transform-origin: center center;
        opacity: 1;
        position: relative;
        z-index: 1;
        background-image: none !important;
        background: transparent !important;
        background-color: transparent !important;
        background-size: unset !important;
        background-position: unset !important;
        background-repeat: unset !important;
    }
    
    /* Full overlay to block ALL interactions including hover - ALWAYS ACTIVE */
    .feature-section .youtube-player-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99999 !important;
        pointer-events: auto !important;
        background: transparent;
        cursor: default !important;
    }
    
    /* Additional overlay blocker element - ALWAYS ACTIVE */
    .feature-section .youtube-player-container .youtube-overlay-blocker {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        height: 100% !important;
        z-index: 100000 !important;
        pointer-events: auto !important;
        background: transparent !important;
        cursor: default !important;
        display: block !important;
    }
    
    /* Prevent any hover effects - overlays stay active on hover */
    .feature-section .youtube-player-container:hover::before {
        pointer-events: auto !important;
        z-index: 99999 !important;
    }
    
    .feature-section .youtube-player-container:hover .youtube-overlay-blocker {
        pointer-events: auto !important;
        z-index: 100000 !important;
    }
    
    /* Ensure overlays are always on top, even when YouTube adds elements */
    .feature-section .youtube-player-container * {
        z-index: auto;
    }
    
    /* Mobile: Scale YouTube video to 2.2 */
    @media (max-width: 768px) {
        .feature-section .youtube-player-container iframe,
        .feature-section iframe.youtube-player-container,
        .feature-section iframe[id^="youtube-player"],
        .feature-section .image-box iframe {
            transform: translateZ(0) scale(2.2) !important;
            -webkit-transform: translateZ(0) scale(2.2) !important;
            transform-origin: center center;
            -webkit-transform-origin: center center;
        }
    }
  </style>

<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>

<script>
    // Store YouTube player instances
    var youtubePlayers = {};
    var youtubeVideoIds = {};
    
    // Set video IDs from server-side data
    <% if (venues && Array.isArray(venues) && venues.length > 0) { %>
        <% venues.forEach((venue, index) => { %>
            <% 
                let youtubeVideoId = null;
                if (venue.youtubeVideo) {
                    const youtubeUrl = venue.youtubeVideo;
                    if (youtubeUrl.includes('youtube.com/watch?v=')) {
                        youtubeVideoId = youtubeUrl.split('v=')[1]?.split('&')[0];
                    } else if (youtubeUrl.includes('youtu.be/')) {
                        youtubeVideoId = youtubeUrl.split('youtu.be/')[1]?.split('?')[0];
                    } else if (youtubeUrl.includes('youtube.com/embed/')) {
                        youtubeVideoId = youtubeUrl.split('embed/')[1]?.split('?')[0];
                    }
                }
            %>
            <% if (youtubeVideoId) { %>
                youtubeVideoIds['youtube-player-<%= index %>'] = '<%= youtubeVideoId.replace(/'/g, "\\'") %>';
                youtubeVideoIds['youtube-player-reversed-<%= index %>'] = '<%= youtubeVideoId.replace(/'/g, "\\'") %>';
            <% } %>
        <% }); %>
    <% } %>
    
    // YouTube API ready callback
    function onYouTubeIframeAPIReady() {
        setTimeout(initializeYouTubePlayers, 500);
    }
    
    // Initialize YouTube players
    function initializeYouTubePlayers() {
        var containers = document.querySelectorAll('.youtube-player-container');
        
        containers.forEach(function(container) {
            var containerId = container.id;
            if (!containerId || youtubePlayers[containerId]) {
                return;
            }
            
            var videoId = youtubeVideoIds[containerId];
            if (!videoId) {
                return;
            }
            
            youtubePlayers[containerId] = new YT.Player(containerId, {
                videoId: videoId,
                width: '100%',
                height: '380',
                playerVars: {
                    'autoplay': 1,
                    'mute': 1,
                    'loop': 1,
                    'playlist': videoId,
                    'controls': 0,
                    'rel': 0,
                    'modestbranding': 1,
                    'playsinline': 1,
                    'vq': 'hd2160',
                    'enablejsapi': 1,
                    'iv_load_policy': 3,
                    'cc_load_policy': 0,
                    'disablekb': 1,
                    'fs': 0,
                    'showinfo': 0,
                    'origin': window.location.origin,
                    'widget_referrer': window.location.origin
                },
                events: {
                    'onReady': function(event) {
                        var player = event.target;
                        var iframe = document.getElementById(containerId);
                        
                        try {
                            player.setPlaybackQuality('hd2160');
                            player.mute();
                            
                            setTimeout(function() {
                                player.setPlaybackQuality('hd2160');
                            }, 50);
                            setTimeout(function() {
                                player.setPlaybackQuality('hd2160');
                            }, 150);
                            setTimeout(function() {
                                player.setPlaybackQuality('hd2160');
                            }, 300);
                            
                            if (iframe && iframe.parentElement) {
                                var container = iframe.parentElement;
                                var blocker = container.querySelector('.youtube-overlay-blocker');
                                if (!blocker) {
                                    blocker = document.createElement('div');
                                    blocker.className = 'youtube-overlay-blocker';
                                    container.appendChild(blocker);
                                }
                                iframe.style.pointerEvents = 'none';
                                
                                iframe.style.backgroundImage = 'none';
                                iframe.style.background = 'transparent';
                                iframe.style.backgroundColor = 'transparent';
                                iframe.style.backgroundSize = 'unset';
                                iframe.style.backgroundPosition = 'unset';
                                iframe.style.backgroundRepeat = 'unset';
                                
                                iframe.style.setProperty('background-image', 'none', 'important');
                                iframe.style.setProperty('background', 'transparent', 'important');
                                iframe.style.setProperty('background-color', 'transparent', 'important');
                                iframe.style.setProperty('background-size', 'unset', 'important');
                                iframe.style.setProperty('background-position', 'unset', 'important');
                                iframe.style.setProperty('background-repeat', 'unset', 'important');
                            }
                            
                            setInterval(function() {
                                try {
                                    if (player.getPlayerState() === YT.PlayerState.PAUSED) {
                                        player.playVideo();
                                    }
                                    player.mute();
                                } catch(e) {
                                }
                            }, 500);
                        } catch(e) {
                        }
                    },
                    'onStateChange': function(event) {
                        var player = event.target;
                        
                        if (event.data === YT.PlayerState.PAUSED) {
                            try {
                                player.playVideo();
                            } catch(e) {
                            }
                        }
                        if (event.data === YT.PlayerState.BUFFERING || 
                            event.data === YT.PlayerState.CUED || 
                            event.data === YT.PlayerState.PLAYING) {
                            try {
                                player.setPlaybackQuality('hd2160');
                                player.mute();
                            } catch(e) {
                            }
                        }
                    },
                    'onPlaybackQualityChange': function(event) {
                        if (event.data !== 'hd2160' && event.data !== 'highres') {
                            try {
                                event.target.setPlaybackQuality('hd2160');
                            } catch(e) {
                            }
                        }
                    }
                }
            });
        });
    }
    
    if (typeof YT !== 'undefined' && YT.Player) {
        onYouTubeIframeAPIReady();
    }
    
    document.addEventListener('contextmenu', function(e) {
        if (e.target.closest('.youtube-player-container')) {
            e.preventDefault();
            return false;
        }
    }, false);
    
    document.addEventListener('keydown', function(e) {
        if (e.target.closest('.youtube-player-container') || 
            (e.key === ' ' || e.key === 'k' || e.key === 'ArrowLeft' || e.key === 'ArrowRight')) {
            if (document.activeElement && document.activeElement.closest('.youtube-player-container')) {
                e.preventDefault();
                return false;
            }
        }
    }, false);
    
    document.addEventListener('dragstart', function(e) {
        if (e.target.closest('.youtube-player-container')) {
            e.preventDefault();
            return false;
        }
    }, false);
    
    function enforceYouTubeBlocking() {
        var containers = document.querySelectorAll('.youtube-player-container');
        containers.forEach(function(container) {
            var iframe = container.querySelector('iframe');
            if (iframe) {
                iframe.style.pointerEvents = 'none';
                
                iframe.style.setProperty('background-image', 'none', 'important');
                iframe.style.setProperty('background', 'transparent', 'important');
                iframe.style.setProperty('background-color', 'transparent', 'important');
                iframe.style.setProperty('background-size', 'unset', 'important');
                iframe.style.setProperty('background-position', 'unset', 'important');
                iframe.style.setProperty('background-repeat', 'unset', 'important');
                
                iframe.style.backgroundImage = 'none';
                iframe.style.background = 'transparent';
                iframe.style.backgroundColor = 'transparent';
                iframe.style.backgroundSize = 'unset';
                iframe.style.backgroundPosition = 'unset';
                iframe.style.backgroundRepeat = 'unset';
                
                iframe.removeAttribute('data-background-image');
                
                var currentStyle = iframe.getAttribute('style') || '';
                currentStyle = currentStyle.replace(/background[^;]*;?/gi, '');
                iframe.setAttribute('style', 
                    currentStyle + 
                    'background-image: none !important; ' +
                    'background: transparent !important; ' +
                    'background-color: transparent !important; ' +
                    'background-size: unset !important; ' +
                    'background-position: unset !important; ' +
                    'background-repeat: unset !important; '
                );
                
                var blocker = container.querySelector('.youtube-overlay-blocker');
                if (!blocker) {
                    blocker = document.createElement('div');
                    blocker.className = 'youtube-overlay-blocker';
                    container.appendChild(blocker);
                }
                blocker.style.cssText = 'position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100000; pointer-events: auto !important; background: transparent; cursor: default;';
            }
        });
    }
    
    enforceYouTubeBlocking();
    setTimeout(enforceYouTubeBlocking, 100);
    setTimeout(enforceYouTubeBlocking, 500);
    setTimeout(enforceYouTubeBlocking, 1000);
    setInterval(enforceYouTubeBlocking, 2000);
    
    if (window.MutationObserver) {
        var observer = new MutationObserver(function(mutations) {
            enforceYouTubeBlocking();
        });
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    }
</script>

  <%- include('footer') %>