<!-- Service Section Three -->
<section class="service-section-three">
  <div class="auto-container">
    <div class="sec-title wow fadeInUp">
      <div class="row">
        <div class="col-lg-6">
          <span class="sub-title">Our Services</span>
          <h2>A Collection of Experiences Beyond Ordinary</h2>
        </div>
        <div class="col-lg-4 offset-lg-2">
          <div class="text">True luxury lies in the details — in the quiet moments, personal touches, and thoughtfully designed experiences that elevate your stay. Explore our curated offerings crafted to complement your lifestyle.</div>
        </div>
      </div>
    </div>
    <div class="carousel-outer">
      <!-- Project Carousel -->
      <div class="swiper service-three-slider">
        <div class="swiper-wrapper" id="services-container">
          <!-- Services will be dynamically inserted here -->
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Service Section -->

<!-- JSON Data -->
<script type="application/json" id="services-data">
[
  {
    "id": 1,
    "title": "Stays",
    "link": "/stay",
    "has360View": true,
    "view360": "/assets/images/360/executivesuite.webp",
    "alt": "Luxury Stays"
  },
  {
    "id": 2,
    "title": "PDR",
    "link": "/dining/pdr",
    
    "has360View": true,
    "view360": "/assets/images/360/PDR.webp",
    "alt": "PDR Dining"
  },
  {
    "id": 3,
    "title": "Oma Air Bar",
    "link": "/dining/oma-air-bar",
    "has360View": true,
    "view360": "/assets/images/360/Omaairbar.webp",
    "alt": "Oma Air Bar"
  },
  {
    "id": 4,
    "title": "Oma Kitchen",
    "link": "/dining/oma-kitchen",
    "has360View": true,
    "view360": "/assets/images/360/Omakitchen.webp",
    "alt": "Oma Kitchen"
  },
  {
    "id": 5,
    "title": "Oma Pool Bar",
    "link": "/dining/oma-pool-bar",
    "has360View": true,
    "view360": "/assets/images/360/Omapoolbar.webp",
    "alt": "Oma Pool Bar"
  },
  {
    "id": 6,
    "title": "Ivory Hall",
    "link": "/venue/ivory-hall",
    "has360View": true,
    "view360": "/assets/images/360/Ivoryhall.webp",
    "alt": "Ivory Hall"
  },
  {
    "id": 7,
    "title": "Silver Hall",
    "link": "/venue/silver-hall",
    "has360View": true,
    "view360": "/assets/images/360/Silverhall.webp",
    "alt": "Silver Hall"
  },
  {
    "id": 8,
    "title": "Omaya Meet",
    "link": "/venue/omaya-meet",
    "has360View": true,
    "view360": "/assets/images/360/Omayameet.webp",
    "alt": "Omaya Meet"
  },
  {
    "id": 9,
    "title": "Zenith",
    "link": "/venue/zenith",
    "has360View": true,
    "view360": "/assets/images/360/Zenith.webp",
    "alt": "Zenith"
  }
]
</script>

<!-- Pannellum 360 Viewer CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css">

<script>
// Store all viewer instances globally
const panoramaViewers = {};

function createServiceCards() {
  try {
    const servicesDataElement = document.getElementById('services-data');
    if (!servicesDataElement) {
      console.error('services-data element not found');
      return false;
    }
    
    const servicesData = JSON.parse(servicesDataElement.textContent);
    const container = document.getElementById('services-container');
    
    if (!container) {
      console.error('services-container element not found');
      return false;
    }
    
    if (!servicesData || !Array.isArray(servicesData) || servicesData.length === 0) {
      console.error('servicesData is not a valid array or is empty:', servicesData);
      return false;
    }
    
    console.log('Creating', servicesData.length, 'service cards');
    
    // Clear any existing content
    container.innerHTML = '';
    
    // Create slides
    servicesData.forEach(service => {
      const slide = document.createElement('div');
      slide.className = 'swiper-slide';
      
      slide.innerHTML = `
        <div class="service-block-three">
          <div class="inner-box">
            ${service.has360View ? `
              <div class="panorama-container" onclick="window.location.href='${service.link}'" style="width: 100%; height: 458px; border-radius: 8px; overflow: hidden; position: relative; background: #f4f6f8; cursor: pointer;">
                <div id="panorama-360-${service.id}" style="width: 100%; height: 458px; position: relative; z-index: 0;"></div>
                <div class="panorama-overlay" style="position: absolute; bottom: 0; left: 0; width: 100%; height: 40%; background: linear-gradient(to top, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 50%, rgba(0, 0, 0, 0) 100%); pointer-events: none; z-index: 1;"></div>
                <div class="panorama-preloader" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; z-index: 10; background: #f4f6f8;">
                  <div class="panorama-spinner"></div>
                </div>
              </div>
            ` : `
              <figure style="height: 100%; margin: 0;" class="image">
                <img style="height: 458px; width: 100%; object-fit: cover;" src="${service.image}" alt="${service.alt}">
              </figure>
            `}
            <div class="content-box" style="z-index: 2;">
              <h4 class="title"><a href="${service.link}">${service.title}</a></h4>
            </div>
          </div>
        </div>
      `;
      
      container.appendChild(slide);
    });
    
    console.log('Service cards created, total slides:', container.children.length);
    return true;
  } catch(error) {
    console.error('Error creating service cards:', error);
    return false;
  }
}

document.addEventListener('DOMContentLoaded', function() {
  if (createServiceCards()) {
    setTimeout(function() {
      initializeSwiper();
      initialize360Views();
    }, 200);
  }
});

// Also try on window load as backup
window.addEventListener('load', function() {
  const container = document.getElementById('services-container');
  if (container && container.children.length === 0) {
    console.log('Window load: No cards found, creating them...');
    if (createServiceCards()) {
      setTimeout(function() {
        initializeSwiper();
        initialize360Views();
      }, 300);
    }
  }
});

function initializeSwiper() {
  const swiperEl = document.querySelector('.service-three-slider');
  if (!swiperEl) {
    console.warn('Swiper element not found');
    return;
  }
  
  // Wait for Swiper library to be available
  if (typeof Swiper === 'undefined') {
    console.warn('Swiper library not loaded, retrying...');
    setTimeout(initializeSwiper, 200);
    return;
  }
  
  // Wait a bit to ensure DOM is ready
  setTimeout(function() {
    // Destroy existing swiper if it exists
    if (swiperEl.swiper) {
      swiperEl.swiper.destroy(true, true);
    }
    
    const servicesData = JSON.parse(document.getElementById('services-data').textContent);
    const totalSlides = servicesData.length;
    
    // For proper looping, we need at least as many slides as the maximum visible
    // With 9 slides, we have enough for looping with up to 4 visible slides
    const maxSlidesPerView = 4;
    
    // Initialize new swiper with proper loop configuration
    const swiper = new Swiper('.service-three-slider', {
      slidesPerView: 1,
      spaceBetween: 30,
      loop: true, // Enable loop - we have 9 slides which is enough
      loopedSlides: maxSlidesPerView, // Duplicate this many slides for seamless loop
      loopAdditionalSlides: 2, // Additional slides to duplicate for better loop
      autoplay: {
        delay: 11000,
        disableOnInteraction: false,
        pauseOnMouseEnter: false,
      },
      speed: 600,
      watchSlidesProgress: true,
      watchSlidesVisibility: true,
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      breakpoints: {
        320: {
          slidesPerView: 1,
          loopedSlides: 2,
        },
        576: {
          slidesPerView: 1,
          loopedSlides: 2,
        },
        768: {
          slidesPerView: 2,
          loopedSlides: 4,
        },
        992: {
          slidesPerView: 2,
          loopedSlides: 4,
        },
        1023: {
          slidesPerView: 3,
          loopedSlides: 6,
        },
        1400: {
          slidesPerView: 4,
          loopedSlides: 8,
        },
      },
      on: {
        init: function() {
          // Force update to ensure loop is properly initialized
          this.update();
          this.updateSlides();
          // Update auto-rotation for the initial active slide after a delay to ensure viewers are loaded
          setTimeout(() => {
            updateAutoRotation(this);
          }, 1000);
        },
        slideChangeTransitionEnd: function() {
          // Ensure loop continues smoothly
          this.update();
          // Update auto-rotation when slide changes
          setTimeout(() => {
            updateAutoRotation(this);
          }, 100);
        },
        slideChange: function() {
          // Also update on slide change (before transition ends) for faster response
          updateAutoRotation(this);
        }
      }
    });
    
    // Store swiper instance globally for access
    swiperEl.swiperInstance = swiper;
    window.serviceSwiperInstance = swiper; // Also store globally for easier access
  }, 150);
}

function initialize360Views() {
  const servicesData = JSON.parse(document.getElementById('services-data').textContent);
  
  servicesData.forEach((service, index) => {
    if (service.has360View && service.view360) {
      initPannellumViewer(service.id, service.view360);
    }
  });
}

function updateAutoRotation(swiper) {
  if (!swiper) return;
  
  const servicesData = JSON.parse(document.getElementById('services-data').textContent);
  
  // Try to get active service ID from slide element first
  let activeServiceId = null;
  
  // Method 1: Get from active slide element
  if (swiper.slides && swiper.slides[swiper.activeIndex]) {
    const activeSlide = swiper.slides[swiper.activeIndex];
    const panoramaContainer = activeSlide.querySelector('[id^="panorama-360-"]');
    if (panoramaContainer) {
      const serviceIdMatch = panoramaContainer.id.match(/panorama-360-(\d+)/);
      if (serviceIdMatch) {
        activeServiceId = parseInt(serviceIdMatch[1]);
      }
    }
  }
  
  // Method 2: Fallback to using realIndex
  if (!activeServiceId) {
    const activeIndex = swiper.realIndex !== undefined ? swiper.realIndex : (swiper.activeIndex || 0);
    const activeService = servicesData[activeIndex];
    if (activeService) {
      activeServiceId = activeService.id;
    }
  }
  
  if (!activeServiceId) return;
  
  // Disable auto-rotation for ALL viewers first
  servicesData.forEach(service => {
    if (service.has360View && panoramaViewers[service.id]) {
      try {
        const viewer = panoramaViewers[service.id];
        // Try multiple methods to stop auto-rotate
        if (typeof viewer.setConfig === 'function') {
          viewer.setConfig({ autoRotate: 0 });
        }
        if (typeof viewer.updateScene === 'function') {
          viewer.updateScene('scene', { autoRotate: 0 });
        }
        if (typeof viewer.stopAutoRotate === 'function') {
          viewer.stopAutoRotate();
        }
        // Direct property access as fallback
        if (viewer.config && viewer.config.scene) {
          viewer.config.scene.autoRotate = 0;
        }
      } catch(e) {
        // Viewer might not be fully initialized yet, ignore error
      }
    }
  });
  
  // Enable auto-rotation ONLY for the active slide
  if (panoramaViewers[activeServiceId]) {
    try {
      const isMobile = 'ontouchstart' in window;
      const rotateSpeed = isMobile ? 1.5 : 10;
      const viewer = panoramaViewers[activeServiceId];
      
      // Clear any existing pitch lock interval
      if (viewer._pitchLockInterval) {
        clearInterval(viewer._pitchLockInterval);
        viewer._pitchLockInterval = null;
      }
      
      // Reset pitch to 0 ONLY (don't reset yaw - let auto-rotate handle it continuously)
      try {
        if (typeof viewer.setPitch === 'function') {
          viewer.setPitch(0);
        }
      } catch(e) {
        try {
          viewer.setConfig({ pitch: 0, minPitch: 0, maxPitch: 0 });
        } catch(e2) {}
      }
      
      // Enable auto-rotate WITHOUT resetting yaw (let it rotate continuously)
      if (typeof viewer.setConfig === 'function') {
        viewer.setConfig({
          autoRotate: rotateSpeed,
          autoRotateInactivityDelay: 0, // Start immediately
          autoRotateStopDelay: 0, // Never stop
          minPitch: 0, // Lock pitch
          maxPitch: 0 // Lock pitch
        });
      }
      if (typeof viewer.updateScene === 'function') {
        viewer.updateScene('scene', {
          autoRotate: rotateSpeed,
          autoRotateInactivityDelay: 0,
          autoRotateStopDelay: 0,
          minPitch: 0,
          maxPitch: 0
        });
      }
      if (typeof viewer.startAutoRotate === 'function') {
        viewer.startAutoRotate(rotateSpeed, 0); // 0 delay = continuous
      }
      // Direct property access as fallback
      if (viewer.config && viewer.config.scene) {
        viewer.config.scene.autoRotate = rotateSpeed;
        viewer.config.scene.autoRotateInactivityDelay = 0;
        viewer.config.scene.autoRotateStopDelay = 0;
        viewer.config.scene.minPitch = 0;
        viewer.config.scene.maxPitch = 0;
      }
      
      // Continuously ensure pitch stays at 0 (ONLY pitch, never touch yaw)
      const pitchLockInterval = setInterval(() => {
        try {
          if (viewer.getPitch && Math.abs(viewer.getPitch()) > 0.1) {
            viewer.setPitch(0);
          }
          // DO NOT touch yaw here - let auto-rotate handle it continuously
        } catch(e) {
          clearInterval(pitchLockInterval);
        }
      }, 100);
      
      // Store interval to clear it later if needed
      viewer._pitchLockInterval = pitchLockInterval;
    } catch(e) {
      // Viewer might not be fully initialized yet, retry after a short delay
      setTimeout(() => {
        if (panoramaViewers[activeServiceId]) {
          try {
            const isMobile = 'ontouchstart' in window;
            const rotateSpeed = isMobile ? 1.5 : 10;
            const viewer = panoramaViewers[activeServiceId];
            // Clear existing pitch lock
            if (viewer._pitchLockInterval) {
              clearInterval(viewer._pitchLockInterval);
            }
            
            // Reset pitch ONLY (don't reset yaw - let auto-rotate continue)
            try {
              if (typeof viewer.setPitch === 'function') {
                viewer.setPitch(0);
              }
            } catch(e3) {
              try {
                viewer.setConfig({ pitch: 0, minPitch: 0, maxPitch: 0 });
              } catch(e4) {}
            }
            
            if (typeof viewer.setConfig === 'function') {
              viewer.setConfig({
                autoRotate: rotateSpeed,
                autoRotateInactivityDelay: 0, // Start immediately
                autoRotateStopDelay: 0, // Never stop
                minPitch: 0,
                maxPitch: 0
              });
            }
            if (typeof viewer.startAutoRotate === 'function') {
              viewer.startAutoRotate(rotateSpeed, 0); // 0 delay = continuous
            }
            
            // Continuously lock pitch ONLY (never touch yaw)
            const pitchLockInterval = setInterval(() => {
              try {
                if (viewer.getPitch && Math.abs(viewer.getPitch()) > 0.1) {
                  viewer.setPitch(0);
                }
              } catch(e) {
                clearInterval(pitchLockInterval);
              }
            }, 100);
            viewer._pitchLockInterval = pitchLockInterval;
          } catch(e2) {
            // Error setting auto-rotate
          }
        }
      }, 1000);
    }
  }
}

function initPannellumViewer(serviceId, panoramaPath) {
  const container = document.getElementById(`panorama-360-${serviceId}`);
  if (!container) return;
  
  const preloader = container.parentElement.querySelector('.panorama-preloader');
  
  function showError(message) {
    if (preloader) {
      preloader.innerHTML = `<div style="text-align: center; color: #666; padding: 20px;"><p style="margin: 0; font-size: 14px;">${message}</p></div>`;
      preloader.style.display = 'flex';
    }
  }
  
  // Load Pannellum if not already loaded
  if (typeof pannellum === 'undefined') {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js';
    script.onload = function() {
      setTimeout(() => initPannellumViewer(serviceId, panoramaPath), 200);
    };
    script.onerror = function() {
      showError('Failed to load 360 viewer.');
    };
    document.head.appendChild(script);
    return;
  }
  
  try {
    let panoramaUrl = panoramaPath;
    if (panoramaPath && !panoramaPath.startsWith('http://') && !panoramaPath.startsWith('https://')) {
      panoramaUrl = window.location.origin + (panoramaPath.startsWith('/') ? panoramaPath : '/' + panoramaPath);
    }
    
    const img = new Image();
    img.onload = function() {
      if (preloader) {
        preloader.style.display = 'none';
      }
      
      try {
        // Check if this is the first service to enable auto-rotate initially
        const servicesData = JSON.parse(document.getElementById('services-data').textContent);
        const isFirstService = servicesData[0] && servicesData[0].id === serviceId;
        const isMobile = 'ontouchstart' in window;
        const rotateSpeed = isMobile ? 1.5 : 10;
        
        const viewerConfig = {
          "type": "equirectangular",
          "panorama": panoramaUrl,
          "autoLoad": true,
          "autoRotate": isFirstService ? rotateSpeed : 0, // Enable for first slide
          "autoRotateInactivityDelay": 0, // Start immediately, no delay
          "autoRotateStopDelay": 0, // Never stop, rotate continuously
          "compass": false,
          "showControls": true,
          "keyboardZoom": false,
          "mouseZoom": false,
          "draggable": true,
          "disableKeyboardCtrl": true,
          "hfov": 100,
          "minHfov": 80,
          "maxHfov": 120,
          "pitch": 0, // Horizontal view (0 = straight ahead, no up/down tilt)
          "yaw": 0, // Starting rotation angle
          "minPitch": 0, // Lock pitch at 0 (no up/down movement)
          "maxPitch": 0, // Lock pitch at 0 (no up/down movement)
          "showFullscreenCtrl": true,
          "showZoomCtrl": false,
          "mouseZoom": false,
          "touchZoom": false,
          "preview": "",
          "sceneFadeDuration": 1000
        };
        
        const viewer = pannellum.viewer(`panorama-360-${serviceId}`, viewerConfig);
        
        // Store viewer instance globally
        panoramaViewers[serviceId] = viewer;
        
        viewer.on('error', function(error) {
          console.error('Pannellum error:', error);
          showError('Unable to load 360° view.');
        });
        
        // Wait for panorama to load before enabling auto-rotate
        viewer.on('load', function() {
          if (isFirstService) {
            // Enable auto-rotation for the first slide after it loads
            setTimeout(() => {
              try {
                const isMobile = 'ontouchstart' in window;
                const rotateSpeed = isMobile ? 1.5 : 10;
                // Clear existing pitch lock
                if (viewer._pitchLockInterval) {
                  clearInterval(viewer._pitchLockInterval);
                }
                
                // Reset pitch ONLY (don't reset yaw)
                try {
                  if (typeof viewer.setPitch === 'function') {
                    viewer.setPitch(0);
                  }
                } catch(e3) {
                  try {
                    viewer.setConfig({ pitch: 0, minPitch: 0, maxPitch: 0 });
                  } catch(e4) {}
                }
                
                // Try multiple methods (don't set yaw - let auto-rotate handle it)
                if (typeof viewer.setConfig === 'function') {
                  viewer.setConfig({
                    autoRotate: rotateSpeed,
                    autoRotateInactivityDelay: 0, // Start immediately
                    autoRotateStopDelay: 0, // Never stop
                    minPitch: 0,
                    maxPitch: 0
                  });
                }
                if (typeof viewer.startAutoRotate === 'function') {
                  viewer.startAutoRotate(rotateSpeed, 0); // 0 delay = continuous
                }
                if (viewer.config && viewer.config.scene) {
                  viewer.config.scene.autoRotate = rotateSpeed;
                  viewer.config.scene.autoRotateInactivityDelay = 0;
                  viewer.config.scene.autoRotateStopDelay = 0;
                  viewer.config.scene.minPitch = 0;
                  viewer.config.scene.maxPitch = 0;
                }
                
                // Continuously lock pitch ONLY (never touch yaw)
                const pitchLockInterval = setInterval(() => {
                  try {
                    if (viewer.getPitch && Math.abs(viewer.getPitch()) > 0.1) {
                      viewer.setPitch(0);
                    }
                  } catch(e) {
                    clearInterval(pitchLockInterval);
                  }
                }, 100);
                viewer._pitchLockInterval = pitchLockInterval;
              } catch(e) {
                // Retry if failed
                setTimeout(() => {
                  try {
                    const isMobile = 'ontouchstart' in window;
                    const rotateSpeed = isMobile ? 1.5 : 10;
                    // Clear existing pitch lock
                    if (viewer._pitchLockInterval) {
                      clearInterval(viewer._pitchLockInterval);
                    }
                    
                    // Reset pitch ONLY (don't reset yaw)
                    try {
                      if (typeof viewer.setPitch === 'function') {
                        viewer.setPitch(0);
                      }
                    } catch(e5) {
                      try {
                        viewer.setConfig({ pitch: 0, minPitch: 0, maxPitch: 0 });
                      } catch(e6) {}
                    }
                    
                    if (typeof viewer.setConfig === 'function') {
                      viewer.setConfig({
                        autoRotate: rotateSpeed,
                        autoRotateInactivityDelay: 0, // Start immediately
                        autoRotateStopDelay: 0, // Never stop
                        minPitch: 0,
                        maxPitch: 0
                      });
                    }
                    if (typeof viewer.startAutoRotate === 'function') {
                      viewer.startAutoRotate(rotateSpeed, 0); // 0 delay = continuous
                    }
                    
                    // Continuously lock pitch ONLY (never touch yaw)
                    const pitchLockInterval = setInterval(() => {
                      try {
                        if (viewer.getPitch && Math.abs(viewer.getPitch()) > 0.1) {
                          viewer.setPitch(0);
                        }
                      } catch(e) {
                        clearInterval(pitchLockInterval);
                      }
                    }, 100);
                    viewer._pitchLockInterval = pitchLockInterval;
                  } catch(e2) {}
                }, 1000);
              }
            }, 1000);
          } else {
            // Ensure non-first slides have auto-rotate disabled
            try {
              if (typeof viewer.setConfig === 'function') {
                viewer.setConfig({ autoRotate: 0 });
              }
              if (typeof viewer.stopAutoRotate === 'function') {
                viewer.stopAutoRotate();
              }
            } catch(e) {}
          }
        });
        
        // After viewer is loaded, check if it should auto-rotate
        // Try multiple ways to get swiper instance
        setTimeout(() => {
          let swiperInstance = null;
          
          // Try method 1: from element
          const swiperEl = document.querySelector('.service-three-slider');
          if (swiperEl && swiperEl.swiperInstance) {
            swiperInstance = swiperEl.swiperInstance;
          }
          
          // Try method 2: from global
          if (!swiperInstance && window.serviceSwiperInstance) {
            swiperInstance = window.serviceSwiperInstance;
          }
          
          // Try method 3: from swiper property
          if (!swiperInstance && swiperEl && swiperEl.swiper) {
            swiperInstance = swiperEl.swiper;
          }
          
          if (swiperInstance) {
            updateAutoRotation(swiperInstance);
          }
        }, 1500);
        
      } catch(e) {
        console.error('Error initializing Pannellum:', e);
        showError('Error loading 360° view.');
      }
    };
    
    img.onerror = function() {
      showError('360° image not available.');
      const serviceData = JSON.parse(document.getElementById('services-data').textContent).find(s => s.id === serviceId);
      if (serviceData && serviceData.image) {
        container.parentElement.innerHTML = `
          <figure style="height: 100%; margin: 0;" class="image">
            <img style="height: 458px; width: 100%; object-fit: cover;" src="${serviceData.image}" alt="${serviceData.alt}">
          </figure>
        `;
      }
    };
    
    img.src = panoramaUrl;
    
  } catch(e) {
    console.error('Error setting up 360 view:', e);
    showError('Error loading 360° view.');
  }
}

// Add CSS for spinner and 360 container (only if not already added)
if (!document.getElementById('panorama-styles-homeproducts')) {
  const panoramaStyle = document.createElement('style');
  panoramaStyle.id = 'panorama-styles-homeproducts';
  panoramaStyle.textContent = `
    .panorama-spinner {
      width: 40px;
      height: 40px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Optimize 360 view for small container */
    .pnlm-container {
      cursor: grab;
    }
    
    .pnlm-container:active {
      cursor: grabbing;
    }
    
    .pnlm-controls {
      opacity: 0.7;
      transition: opacity 0.3s;
    }
    
    .pnlm-controls:hover {
      opacity: 1;
    }
  `;
  document.head.appendChild(panoramaStyle);
}
</script>