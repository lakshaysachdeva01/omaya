     <!-- news-section two -->
  <section id="news" class="news-section-two">
    <div class="auto-container">
      <div class="sec-title text-center wow fadeInUp"> <span class="sub-title">Omaya Insights</span>
        <h2>Latest update</h2>
      </div>
      <div class="row"> 
        <% if (blogs && Array.isArray(blogs) && blogs.length > 0) { %>
          <% 
            const imageBase = typeof S3_BASE_URL !== 'undefined' && S3_BASE_URL 
              ? S3_BASE_URL.replace(/\/$/, '') + '/' 
              : '';
            
            // Helper function to strip HTML and get first sentence/words for description
            function getDescriptionPreview(descriptionArray) {
              if (!descriptionArray || !Array.isArray(descriptionArray) || descriptionArray.length === 0) {
                return 'Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, quos.';
              }
              const firstDesc = descriptionArray[0].description || '';
              // Strip HTML tags and get first ~50 words
              const text = firstDesc.replace(/<[^>]*>/g, '').trim();
              const words = text.split(/\s+/);
              return words.length > 50 ? words.slice(0, 50).join(' ') + '...' : text;
            }
            
            // Helper function to format date
            function formatDate(dateString) {
              if (!dateString) return '';
              try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-GB', { 
                  day: '2-digit', 
                  month: 'short', 
                  year: 'numeric' 
                });
              } catch (e) {
                return '';
              }
            }
            
            // Helper function to format date as DD <br/> MMM
            function formatDateDisplay(dateString) {
              if (!dateString) return '';
              try {
                const date = new Date(dateString);
                const day = date.getDate().toString().padStart(2, '0');
                const month = date.toLocaleDateString('en-GB', { month: 'short' });
                return day + ' <br/> ' + month;
              } catch (e) {
                return '';
              }
            }
          %>
          <% blogs.slice(0, 3).forEach((item, index) => { %>
            <% 
              const imageUrl = item.coverImage || item.uploadBanner || '';
              const slug = item.seoConfigs?.slug || item.seoconfigs?.slug || item.seoDetails?.slug || '';
              const category = item.postCategory || 'BLOG';
              const title = item.postTitle || item.title || '';
              const date = item.postDate || formatDate(item.createdAt);
              const dateDisplay = formatDateDisplay(item.postDate || item.createdAt);
              const description = getDescriptionPreview(item.description);
            %>
              <!-- News Block -->
        <div class="news-block col-lg-4 col-md-6 wow fadeInUp">
          <div class="inner-box wow fadeInLeft">
            <div class="image-box">
              <figure class="image overlay-anim"><a href="/blog/<%= slug %>"><img style="height: 374px; object-fit: cover;" src="<%= imageBase + imageUrl %>" alt="<%= title %>"></a></figure>
              <span class="date" style="text-transform: uppercase;"><%- dateDisplay %></span>
            </div>
            <div class="content-box">
              <ul class="post-info">
                <li style="text-transform: uppercase;"><%= category %></li>
              </ul>
              <h4 class="title"><a href="/blog/<%= slug %>" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis;"><%= title %></a></h4>
              <a href="/blog/<%= slug %>" class="read-more">Read More<i class="fa-solid fa-arrow-right"></i></a>
            </div>
          </div>
        </div>
   

     
  <!-- End news section -->

          <% }); %>
        <% } %>
      </div>
    </div>
  </section>

<style>
  .news-section-two .blog-home-image {
    width: 100%;
    height: 400px;
    object-fit: cover;
  }

  @media (max-width: 768px) {
    .news-section-two .blog-home-image {
      height: 340px;
      object-fit: cover;
    }
  }
</style>
